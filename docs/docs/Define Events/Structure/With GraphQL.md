# With GraphQL

This event structure is for advanced usage, it allows the server to resolve additional data that wasn't sent with the event client side, useful to attach additional data server side that the client doesn't know or care about.

For info on JMESPath and its specification visit [jmespath.org](https://jmespath.org)

```yaml
/* name of event, sent to the datawarehouse */
name: quotes_signed

/* a descriptive explanation of what the event means or when it is collected */
description: When quotes are signed in the offer screen

/* the autogenerated handle in client code */
accessor: quotesSigned

/* list of inputs that are required for this event, optional */
inputs:

  /* name of the input, gets materialised into the datewarehouse as property_quote_ids in this case */
  - name: quote_ids

    /* type of the input, see episode on types for all types */
    type: Array<String>

    /* the code generated handle */
    argument: quoteIds

/* graphql configuration, optional */
graphql:

  /* query to fetch to resolve additional data server side */
  query: |
    query QuotesSigned($quote_ids: [ID!]!) {
      quoteBundle(input: {
        ids: $quote_ids
      }) {
        quotes {
          typeOfContract
          initiatedFrom
        }
      }
    }

  /* which variables to pass into graphql, corresponds to the name in inputs or constants */
  variables:
    - quote_ids

  /* selectors define how to retrive data from GraphQL response */
  selectors:

    /* name of resolved data point, materialises into property_type_of_contracts in this case */
    - name: type_of_contracts

      /* type of the input, see episode on types for all types */
      type: String

      /* a JMESPath specced getter */
      path: quoteBundle.quotes[*].typeOfContract | sort(@) | join(', ', @)

    /* name of resolved data point, materialises into property_initiated_from in this case */
    - name: initiated_from

      /* type of the input, see episode on types for all types */
      type: String

      /* a JMESPath specced getter */
      path: quoteBundle.quotes[0].initiatedFrom
```
